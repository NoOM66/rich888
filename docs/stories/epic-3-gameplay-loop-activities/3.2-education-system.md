# Story 3.2: Implement Education System

**Epic:** Gameplay Loop & Activities

## 1. Story
ในฐานะผู้เล่น (As a player), ฉันต้องการที่จะสามารถลงทะเบียนเรียนและเรียนจบคอร์สการศึกษาต่างๆ เพื่อเพิ่มค่าสถานะการศึกษาของฉัน (I want to be able to enroll in and complete educational courses to increase my education stat) เพื่อที่ฉันจะได้ปลดล็อกโอกาสในการทำงานที่ดีขึ้นและพัฒนาความสามารถของตัวละคร (so I can unlock better job opportunities and improve my character's capabilities).

## 2. Acceptance Criteria (เกณฑ์การยอมรับ)
- [ ] มี `EducationManager.cs` Script ในโปรเจกต์
- [ ] เกมมีชุดของคอร์สการศึกษาที่กำหนดไว้ล่วงหน้า (เช่น ใช้ ScriptableObject สำหรับแต่ละคอร์ส)
- [ ] แต่ละคอร์สมีคุณสมบัติเช่น `name`, `description`, `cost`, `timeRequired` (เวลาที่ใช้เรียน), `educationGain` (ค่าการศึกษาที่ได้รับ), `prerequisiteEducationLevel` (ระดับการศึกษาที่ต้องมีก่อนเรียน)
- [ ] ผู้เล่นสามารถลงทะเบียนเรียนคอร์สได้ หากมีคุณสมบัติตรงตามข้อกำหนดและมีเงิน/เวลาเพียงพอ
- [ ] การเรียนจบคอร์สจะเพิ่มค่าสถานะการศึกษาของผู้เล่นอย่างถูกต้อง
- [ ] การเรียนคอร์สจะใช้ "งบเวลา" และหักเงินค่าเรียน
- [ ] ระบบสามารถจัดการการเรียนจบคอร์สได้ (เช่น หลังจากผ่านไปจำนวนสัปดาห์/เทิร์นที่กำหนด)
- [ ] ผู้เล่นสามารถดูระดับการศึกษาปัจจุบันและคอร์สที่สามารถเรียนได้

## 3. Tasks / Subtasks (งานย่อย)
- [ ] **1. สร้าง ScriptableObject สำหรับ Course:**
  - [ ] 1.1. สร้าง C# Script `CourseSO.cs` ที่สืบทอดจาก `ScriptableObject`
  - [ ] 1.2. กำหนด Fields: `courseName`, `description`, `cost`, `timeRequired` (เวลาที่ใช้เรียน), `educationGain` (ค่าการศึกษาที่ได้รับ), `prerequisiteEducationLevel` (ระดับการศึกษาที่ต้องมีก่อนเรียน)
  - [ ] 1.3. สร้าง Asset สำหรับ Course ตัวอย่าง 2-3 คอร์ส

- [ ] **2. สร้าง EducationManager Script:**
  - [ ] 2.1. สร้าง C# Script ใหม่ชื่อ `EducationManager.cs` และทำให้เป็น Singleton
  - [ ] 2.2. เก็บ Reference ไปยัง `CurrentCourse` ที่ผู้เล่นกำลังเรียนอยู่

- [ ] **3. ขยาย PlayerData สำหรับข้อมูลการศึกษา:**
  - [ ] 3.1. ใน `PlayerData.cs`, เพิ่ม `CurrentCourseSO currentCourse;` และ `int currentEducationLevel;`

- [ ] **4. พัฒนากลไกการลงทะเบียนเรียน:**
  - [ ] 4.1. สร้างฟังก์ชัน `public bool EnrollCourse(CourseSO course)`
  - [ ] 4.2. ตรวจสอบ `prerequisiteEducationLevel`, เงินสด, และ `TimeBudget`
  - [ ] 4.3. หากเงื่อนไขครบถ้วน, หักเงิน, ใช้เวลา, กำหนด `CurrentCourse`, และคืนค่า `true`

- [ ] **5. พัฒนากลไกการเรียนจบคอร์ส:**
  - [ ] 5.1. ให้ `EducationManager` ดักฟัง Event `OnWeekStart` จาก `TurnManager`
  - [ ] 5.2. หากมี `CurrentCourse` ที่กำลังเรียนอยู่, ให้ติดตามความคืบหน้า (เช่น `weeksRemaining`)
  - [ ] 5.3. เมื่อเรียนจบ:
    - [ ] เรียก `PlayerStatsController.AddEducation(CurrentCourse.educationGain)`
    - [ ] เคลียร์ `CurrentCourse`
    - [ ] ยิง Event `OnCourseCompleted`

- [ ] **6. เชื่อมต่อกับระบบ Event:**
  - [ ] 6.1. ใช้ Global Event System สำหรับ Event ต่างๆ เช่น `OnCourseEnrolled`, `OnCourseCompleted`

- [ ] **7. เขียน Unit Tests:**
  - [ ] 7.1. เทส `EnrollCourse` (ทั้งกรณีที่ผ่านและไม่ผ่านเงื่อนไข)
  - [ ] 7.2. เทสกลไกการเรียนจบคอร์ส (การเพิ่มค่าการศึกษา, การเคลียร์คอร์ส)
  - [ ] 7.3. เทสการยิง Event

## 4. Dev Notes (บันทึกสำหรับนักพัฒนา)
- การออกแบบ `CourseSO` ให้ยืดหยุ่นจะช่วยให้เพิ่มคอร์สใหม่ๆ ได้ง่ายในอนาคต
- ควรมี UI ชั่วคราวสำหรับแสดงคอร์สที่กำลังเรียนอยู่, ความคืบหน้า, และคอร์สที่สามารถลงทะเบียนได้ เพื่อใช้ในการดีบัก

## 5. QA / Testing Notes (บันทึกสำหรับ QA และการทดสอบ)
- ทดสอบการลงทะเบียนเรียนในทุกกรณี (มีคุณสมบัติ/ไม่มีคุณสมบัติ, เงินพอ/ไม่พอ, เวลาพอ/ไม่พอ)
- ทดสอบการเรียนจบคอร์สและการเพิ่มค่า Education
- ทดสอบการยกเลิกคอร์ส (ถ้ามี)

## 6. Dependencies (สตอรี่ที่เกี่ยวข้อง)
- **Story 1.2: Implement Turn & Time Management System:** `EducationManager` ต้องใช้ Event `OnWeekStart` เพื่อติดตามความคืบหน้าของคอร์ส
- **Story 1.3: Implement Player Stats System:** `EducationManager` ต้องเรียกใช้ฟังก์ชันใน `PlayerStatsController` เพื่อจัดการเงินและค่า Education
- **Story 1.5: Implement Global Event System:** ต้องใช้ระบบ Event กลางในการส่ง Event ต่างๆ
- **Story 3.1: Implement Job, Career Path, and Salary System:** `JobManager` จะใช้ `currentEducationLevel` ใน `PlayerData` เพื่อตรวจสอบคุณสมบัติการเลื่อนตำแหน่ง

---
## Dev Agent Record
- **Agent Model Used:**
- **Debug Log References:**
- **Completion Notes:**
- **File List:**
- **Change Log:**
